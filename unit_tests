#!/usr/bin/env python3

import sys

from Xor.Xor import Xor
from Aes.AES import Aes

def xorTests():

    #-b test
    xor = Xor("576861742069732064656164206d6179206e6576657220646965")
    cypher = xor._encrypt("You know nothing, Jon Snow")
    assert cypher == "20070f2700071c6a4449060a490515164e4e12190b190011063c"
    decypher = xor._decrypt(cypher)
    assert decypher == "You know nothing, Jon Snow"

    # Long key test
    xor = Xor("576861742069732064656164206d6179206e65766572206469651234")
    cypher = xor._encrypt("You know nothing, Jon Snow")
    decypher = xor._decrypt(cypher)
    assert decypher == "You know nothing, Jon Snow"

    # Short key test
    xor = Xor("576861742069732064656164206d6179206e6576657220646965")
    cypher = xor._encrypt("You know nothing, Jon Snow is the best")
    decypher = xor._decrypt(cypher)
    assert decypher == "You know nothing, Jon Snow is the best"

def aesTests():

    #-b test
    aes = Aes("57696e74657220697320636f6d696e67")
    cypher = aes._encrypt("All men must die")
    assert cypher == "e9ffa03b5b0f4a52291e281b8ae18a9a"
    decypher = aes._decrypt("e9ffa03b5b0f4a52291e281b8ae18a9a")
    assert decypher == "All men must die"

    # Short messag test
    aes = Aes("57696e74657220697320636f6d696e67")
    cypher = aes._encrypt("All men must d")
    assert cypher == "da571027847826595a3c6a9cf4471454"
    decypher = aes._decrypt("da571027847826595a3c6a9cf4471454")
    assert decypher == "All men must d"

    # Long messag test
    aes = Aes("57696e74657220697320636f6d696e67")
    cypher = aes._encrypt("All men must die ahah")
    assert cypher == "8e71b8819515985760538897e94bb982e9ffa03b5b0f4a52291e281b8ae18a9a"
    decypher = aes._decrypt("8e71b8819515985760538897e94bb982e9ffa03b5b0f4a52291e281b8ae18a9a")
    assert decypher == "All men must die ahah"

def main():
    xorTests()
    aesTests()

if __name__ == "__main__":
    main()
    print("Everything's good")
