#!/usr/bin/env python3

import sys

from Xor.Xor import Xor
from Aes.Aes import Aes

def xorTests():

    #-b test
    cypher = Xor("You know nothing, Jon Snow", "576861742069732064656164206d6179206e6576657220646965")
    decypher = Xor(cypher.cypherMessage(), "576861742069732064656164206d6179206e6576657220646965")
    assert decypher.decypherMessage() == "You know nothing, Jon Snow"

    #Long key test
    cypher = Xor("You know nothing, Jon Snow", "576861742069732064656164206d6179206e65766572206469651234")
    decypher = Xor(cypher.cypherMessage(), "576861742069732064656164206d6179206e65766572206469651234")
    assert decypher.decypherMessage() == "You know nothing, Jon Snow"

    #Short key test
    cypher = Xor("You know nothing, Jon Snow is the best", "576861742069732064656164206d6179206e6576657220646965")
    decypher = Xor(cypher.cypherMessage(), "576861742069732064656164206d6179206e6576657220646965")
    assert decypher.decypherMessage() == "You know nothing, Jon Snow is the best"

def aesTests():

    #-b test
    cypher = Aes("All men must die", "57696e74657220697320636f6d696e67")
    assert cypher.cypherMessage() == "744ce22c385958348f0df26eceb62eef"
    decypher = Aes(cypher.cypherMessage(), "57696e74657220697320636f6d696e67")
    assert decypher.decypherMessage() == "All men must die"

def main():
    xorTests()
    aesTests()

if __name__ == "__main__":
    main()
    print("Everything's good")
